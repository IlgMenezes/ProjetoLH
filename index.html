<!DOCTYPE html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<title>Gestão de horas de Projeto</title>
    <meta name="keywords" content="">
	<meta name="description" content="">
    
	<!-- Google Fonts -->
	<link href="http://fonts.googleapis.com/css?family=PT+Serif:400,700,400italic,700itali" rel="stylesheet">
	<link href="http://fonts.googleapis.com/css?family=Raleway:400,900,800,700,500,200,100,600" rel="stylesheet">

	<!-- Stylesheets -->
	<link rel="stylesheet" href="bootstrap/bootstrap.css">
	<link rel="stylesheet" href="css/misc.css">
	<link rel="stylesheet" href="css/blue-scheme.css">
	
	<!-- JavaScripts -->
	<script src="js/jquery-1.10.2.min.js"></script>
	<script src="js/jquery-migrate-1.2.1.min.js"></script>

<link rel="icon" href="https://simatec.com.br/wp-content/uploads/2017/03/cropped-logotipo_Horizontal_Poli-32x32.png" sizes="32x32">

</head>
<body>
	<div class="responsive_menu">
        <ul class="main_menu">
            <li><a href="index.html">Home</a></li>
            <li><a href="#">Sair</a></li>

        </ul> <!-- /.main_menu -->
    </div> <!-- /.responsive_menu -->

	<header class="site-header clearfix">
		<div class="container">

			<div class="row">

				<div class="col-md-12">

					<div class="pull-left">
						<a href="index.html">
							<h1><strong> Gestão de horas de Projeto</strong> </h1>
						</a>
					</div>	<!-- /.logo -->

					<div class="main-navigation pull-right">

						<nav class="main-nav visible-md visible-lg">
							<ul class="sf-menu">
								<li><a href="index.html">Home</a></li>
								<li><a href="#">Sair</a></li>
								<li>
									<div style="display: flex; align-items: center;">
										<i class="fa fa-user fa-1x"></i> <a  id="nomeUsuario" href="#" style="padding-left: 4px;"></a>
									</div>
								</li>
							</ul> <!-- /.sf-menu -->
						</nav> <!-- /.main-nav -->

						<!-- This one in here is responsive menu for tablet and mobiles -->
					    <div class="responsive-navigation visible-sm visible-xs">
					        <a href="#nogo" class="menu-toggle-btn">
					            <i class="fa fa-bars"></i>
					        </a>
					    </div> <!-- /responsive_navigation -->

					</div> <!-- /.main-navigation -->

				</div> <!-- /.col-md-12 -->

			</div> <!-- /.row -->

		</div> <!-- /.container -->
	</header> <!-- /.site-header -->

	<section class="cta clearfix">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					
				</div> <!-- /.col-md-12 -->
			</div> <!-- /.row -->
		</div> <!-- /.container -->
	</section> <!-- /.cta -->

	<section class="light-content services">
		<div class="container" style="padding-top: 32px;">
			<div class="row">
				<a href="./apontamento_horas.html" data-nivel-minimo="1" id="card-apontarHoras">
					<div href="./apontamento_horas.html" class="col-md-3 col-sm-3">
						<div class="service-box-wrap">
							<div class="service-icon-wrap">
								<i class="fa fa-clock-o fa-4x"></i>
							</div> <!-- /.service-icon-wrap -->
							<div class="service-cnt-wrap">
								<h3 class="service-title">Apontar Horas</h3>
								<p>Adicionar novo apontamento de Horas.</p>
							</div> <!-- /.service-cnt-wrap -->
						</div> <!-- /.service-box-wrap -->
					</div> <!-- /.col-md-4 -->
				</a>
				<a href="./listagem_apontamentos.html" data-nivel-minimo="1" id="card-listagemHoras">
					<div class="col-md-3 col-sm-3">
						<div class="service-box-wrap">
							<div class="service-icon-wrap">
								<i class="fa fa-th-list fa-3x"></i>
							</div> <!-- /.service-icon-wrap -->
							<div class="service-cnt-wrap">
								<h3 class="service-title">Listagem de Horas</h3>
								<p>Exibir a listagem de todas as horas apontadas</p>
							</div> <!-- /.service-cnt-wrap -->
						</div> <!-- /.service-box-wrap -->
					</div> <!-- /.col-md-4 -->
				</a>
				<a href="./listagem_projetos.html" data-nivel-minimo="3" id="card-cadastrarProjeto">
					<div class="col-md-3 col-sm-3">
						<div class="service-box-wrap">
							<div class="service-icon-wrap">
								<i class="fa fa-pencil-square-o fa-4x"></i>
							</div> <!-- /.service-icon-wrap -->
							<div class="service-cnt-wrap">
								<h3 class="service-title">Cadastro de Projetos</h3>
								<p>Criar e editar Projetos.</p>
							</div> <!-- /.service-cnt-wrap -->
						</div> <!-- /.service-box-wrap -->
					</div> <!-- /.col-md-4 -->
				</a>
				<a href="./listagem_usuarios.html" data-nivel-minimo="2" id="card-gerenciarUsuario">
					<div class="col-md-3 col-sm-3">
						<div class="service-box-wrap">
							<div class="service-icon-wrap">
								<i class="fa fa-user fa-4x"></i>
							</div> <!-- /.service-icon-wrap -->
							<div class="service-cnt-wrap">
								<h3 class="service-title">Gerenciar Usuarios</h3>
								<p>Gerenciar usuário no sistema.</p>
							</div> <!-- /.service-cnt-wrap -->
						</div> <!-- /.service-box-wrap -->
					</div> <!-- /.col-md-4 -->
				</a>
			</div>

			<div class="row">
				<a href="./listagem_projetos.html" data-nivel-minimo="3" id="card-gerenciarProjeto">
					<div class="col-md-3 col-sm-3">
						<div class="service-box-wrap">
							<div class="service-icon-wrap">
								<i class="fa fa-tachometer fa-4x"></i>
							</div> <!-- /.service-icon-wrap -->
							<div class="service-cnt-wrap">
								<h3 class="service-title">Gerenciar Projeto</h3>
								<p>Exibir informações consolidadas de um projeto</p>
							</div> <!-- /.service-cnt-wrap -->
						</div> <!-- /.service-box-wrap -->
					</div> <!-- /.col-md-4 -->
				</a>
				<a href="#" data-nivel-minimo="1" id="card-listagemHoras" onclick="atualizarLink(event)">
					<div class="col-md-3 col-sm-3">
						<div class="service-box-wrap">
							<div class="service-icon-wrap">
								<img src="https://img.icons8.com/?size=70&id=zpgtCKZM3aEb&format=png&color=00a8d6" alt="icon">
							</div> <!-- /.service-icon-wrap -->
							<div class="service-cnt-wrap">
								<h3 class="service-title">Despesas</h3>
								<p>Controlar as Despesas dos Projetos.</p>
							</div> <!-- /.service-cnt-wrap -->
						</div> <!-- /.service-box-wrap -->
					</div> <!-- /.col-md-4 -->
				</a>
			</div> <!-- /.row -->
		</div> <!-- /.container -->
	</section> <!-- /.services -->

	

	<footer class="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<nav class="footer-nav clearfix">
						<ul class="footer-menu">
							<li><a href="index.html">Home</a></li>
							<li><a href="#">Sair</a></li>
						</ul> <!-- /.footer-menu -->
					</nav> <!-- /.footer-nav -->
				</div> <!-- /.col-md-12 -->
			</div> <!-- /.row -->
			<div class="row">
				<div class="col-md-12">
					<p class="copyright-text">Copyright &copy; 2023 SIMATEC</p>
				</div> <!-- /.col-md-12 -->
			</div> <!-- /.row -->
		</div> <!-- /.container -->
		</footer> <!-- /.site-footer -->

	<!-- Scripts -->
	<script src="js/min/plugins.min.js"></script>
	<script src="js/min/medigo-custom.min.js"></script>
	<script>
		var urlParams = new URLSearchParams(window.location.search);
        var token = urlParams.get('token');
		var baseUrl;
		
		$(document).ready(function() {
			if (window.location.hostname === "localhost") {
				baseUrl = "https://localhost:44349/";
			} else {
				baseUrl = "https://sghapi20230704112902.azurewebsites.net/";
			}
			
			if(validateToken()){
				var nomeUsuario = urlParams.get('name');
				$('#nomeUsuario').text(nomeUsuario);
			}
        });
		
		function validateToken() {
			$('.light-content.services a').hide();
			if (token) {
				localStorage.setItem('jwtToken', token);
				localStorage.setItem('uid', urlParams.get('usuarioId'));
				localStorage.setItem('uname', urlParams.get('name'));
				var maiorFunc = parseInt(urlParams.get('maiorFunc'));
				localStorage.setItem('maiorFunc', maiorFunc);
				
				if (maiorFunc >= 2)
					$('.light-content.services a').show();
				else
					$(".light-content.services a").each(function() {
						var nivelMinimo = parseInt($(this).attr('data-nivel-minimo'));

						if (maiorFunc >= nivelMinimo) {
							$(this).show();
						} else {
							$(this).hide();
						}
					});
				return true;
			}
			else{
				
				window.location.href = baseUrl + "home";
			}
		}

		function atualizarLink(event) {
        event.preventDefault(); 
        const dataAtual = new Date();
        const dataInicio = new Date(dataAtual.getFullYear(), dataAtual.getMonth(), 1);
        const dataInicioStr = `${dataInicio.getDate().toString().padStart(2, '0')}/${(dataInicio.getMonth() + 1).toString().padStart(2, '0')}/${dataInicio.getFullYear()}`;
        
        // Último dia do mês
        const dataFim = new Date(dataAtual.getFullYear(), dataAtual.getMonth() + 1, 0);
        const dataFimStr = `${dataFim.getDate().toString().padStart(2, '0')}/${(dataFim.getMonth() + 1).toString().padStart(2, '0')}/${dataFim.getFullYear()}`;
        
        const novaUrl = `./listagem_despesas.html?dataInicio=${dataInicioStr}&dataFim=${dataFimStr}`;
        window.location.href = novaUrl;
    }
		
	</script>
</body>
</html>